import Backbone from '../utils/BackboneAdapter';

const AccessRights = Backbone.Model.extend({
	defaults: {
		rights: []
	},

	hasAll(rights) {
		const matches = rights.filter(right => this.has(right));
		return matches.length === rights.length;
	},

	has(strRight) {
		const rights = this.get('rights');
		if (strRight.includes('.')) {
			return rights
				.some(right => right === strRight);
		}
		return rights
			.map(right => right.split('.')[0])
			.some(right => right === strRight);
	}
});

export default AccessRights;
