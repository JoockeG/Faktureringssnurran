'use strict';

import jsdom from 'jsdom';
import Enzyme from 'enzyme';
import Adapter from 'enzyme-adapter-react-16';

Enzyme.configure({ adapter: new Adapter() });
// setup the simplest document possible
var doc = jsdom.jsdom('<!doctype html><html><body></body></html>');

// get the window object out of the document
var win = doc.defaultView;

// set globals for mocha that make access to document and window feel
// natural in the test environment
global.document = doc;
global.window = win;
//Setup sessionStorage for testing purposes
var sessionStorage = {
	getItem: function (key) {
		return this[key];
	},
	setItem: function (key, value) {
		this[key] = value;
	}
};

sessionStorage.setItem('currentUserRights', JSON.stringify(
	[ 'bf.altervoucher','kf.bookinvoice']
));

win.sessionStorage = sessionStorage;

// from mocha-jsdom https://github.com/rstacruz/mocha-jsdom/blob/master/index.js#L80
function propagateToGlobal (window) {
	for (let key in window) {
		if (!window.hasOwnProperty(key)) {
			continue;
		}
		if (key in global) {
			continue;
		}

		global[key] = window[key];
	}
}

// take all properties of the window object and also attach it to the
// mocha global object
propagateToGlobal(win);
