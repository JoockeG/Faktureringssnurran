import React from 'react';
import TestUtils from 'react-dom/test-utils';
import Backbone from 'utils/BackboneAdapter';
import 'utils/AjaxStub';
import FieldTextBinding from 'form/TextReadBinding';


describe('Form FieldTextBinding', () => {

	it('Should correctly handle databinding for static readonly text tags', done => {
		const p = new Backbone.Model({ name: 'John Doe' });
		const component = TestUtils.renderIntoDocument(
			<FieldTextBinding model={p} modelProp="name" />
		);

		const tag = TestUtils.findRenderedDOMComponentWithTag(component, 'span');

		tag.textContent.should.equal('John Doe');
		p.set('name', 'Rutger');
		tag.textContent.should.equal('Rutger');

		done();
	});

	it('Should custom format the output when using a format function', done => {
		const p = new Backbone.Model({ name: 'John Doe' });
		const component = TestUtils.renderIntoDocument(
			<FieldTextBinding model={p} modelProp="name" format={value => (value + ' ...')} />
		);

		const tag = TestUtils.findRenderedDOMComponentWithTag(component, 'span');

		tag.textContent.should.equal('John Doe ...');
		done();
	});


});
