import React from 'react';
import ReactDOM from 'react-dom';
import TestUtils from 'react-dom/test-utils';
import Backbone from 'utils/BackboneAdapter';
import FieldText from 'form/TextBox';
import FieldPhone from 'form/Phone';

import 'utils/AjaxStub'

describe('Form FieldPhone', () => {

	it('Correctly validates a phone number', done => {
		const m = new Backbone.Model();
		const component = TestUtils.renderIntoDocument(
			<FieldPhone model={m} modelProp="phoneno" />
		);
		const input = TestUtils.findRenderedDOMComponentWithTag(component, 'input');

		input.value = 'abc';
		TestUtils.Simulate.change(ReactDOM.findDOMNode(input));
		TestUtils.Simulate.blur(ReactDOM.findDOMNode(input));
		TestUtils.findRenderedComponentWithType(component, FieldText).state.isValid.should.be.false();


		input.value = '0708099800';
		TestUtils.Simulate.change(ReactDOM.findDOMNode(input));
		TestUtils.Simulate.blur(ReactDOM.findDOMNode(input));
		TestUtils.findRenderedComponentWithType(component, FieldText).state.isValid.should.be.true();

		done();
	});

});
