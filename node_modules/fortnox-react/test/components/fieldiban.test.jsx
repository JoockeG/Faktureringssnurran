import React from 'react';
import TestUtils from 'react-dom/test-utils';
import Backbone from 'utils/BackboneAdapter';
import 'utils/AjaxStub'
import FieldIban from 'form/IBAN';

import testDataBinding from 'utils/TestDataBinding';

describe('Form FieldIban', () => {

	it('Should validate ibans correctly', done => {
		const p = new Backbone.Model({ name: 'Rutger' });
		const component = TestUtils.renderIntoDocument(
			<FieldIban model={p} modelProp="foo" />
		);
		const input = TestUtils.findRenderedDOMComponentWithTag(component, 'input');

		component.validate('DK5000400440116243').should.be.true();
		component.validate('DK5000400FGHJKLÖ440116243').should.equal('DK5000400FGHJKLÖ440116243 är inte ett giltigt IBAN.');
		component.validate('EG1100006001880800100014553').should.be.true();
		component.validate('MU17BOMM0101101030300200000MUR').should.be.true();
		component.validate('GB29NWBK60161331926819').should.be.true();
		component.validate('14').should.equal('14 är inte ett giltigt IBAN.');
		done();
	});

	it('should handle databinding correctly', done => {
		const p = new Backbone.Model({ name: 'Rutger' });
		const component = TestUtils.renderIntoDocument(
			<FieldIban model={p} modelProp="foo" />
		);
		const input = TestUtils.findRenderedDOMComponentWithTag(component, 'input');
		testDataBinding(input, p, 'foo');
		done();
	});

});
